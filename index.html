<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>HI</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://code.jquery.com/jquery-2.2.4.min.js"
            integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>
    <script src="https://cdn.gravitec.net/sites/gudz/client.js" async></script>
</head>
<body>
<div id="timerContainer"><span id="timer"></span> sec to subscribe</div>
<div id="tagscontainer" style="display: none">
    <p>
        <input type="text">
        <button class="add">Add tag</button>
    </p>
    <p style="margin-top: 20px;">
        <button class="removeAll">Remove all tags</button>
    </p>
</div>
<div id="apiStack" style="position: fixed; top: 0;right: 0; border: 1px solid black; padding: 10px;width: 400px;"></div>
<script>
    var secs = 3;
    var timeContainer = $('#timer');
    var tagsContainer = $("#tagscontainer");
    var apiStack = $('#apiStack');
    var Gravitec = Gravitec || [];
    Gravitec.push(["init", {"autoRegister": false}]);
    apiStack.append('<p>var Gravitec = Gravitec || [];<br/>Gravitec.push(["init", {"autoRegister": false}]);</p>')
    var interval = setInterval(tick, 1000);
    tick();
    function tick() {
        if (secs > 0) {
            secs--;
            timeContainer.html(secs);
        }
        else {
            clearInterval(interval);
            onTimeout();
        }
    }

    function onTimeout() {
        Gravitec.push(["registerUserForPush", onSubscribed]);
        apiStack.append('<p>Gravitec.push(["registerUserForPush", onSubscribed]);</p>');
    }

    function onTagAdd() {
        var val = tagsContainer.find('input').val();
        if (val) {
            Gravitec.push(['addTag', val]);
            apiStack.append('<p>Gravitec.push(["addTag", "' + val + '"]);</p>');
        }
        else {
            alert('Tag entered is empty');
        }
    }

    function onTagsRemove() {
        Gravitec.push(["removeAllTags"]);
        apiStack.append('<p>Gravitec.push(["removeAllTags"]);</p>');
    }

    function onSubscribed() {
        apiStack.append('<p>onSubscribed function triggered</p>');
        $('#timerContainer').hide();
        tagsContainer.show();
        tagsContainer.find('button.add').on('click', onTagAdd);
        tagsContainer.find('button.removeAll').on('click', onTagsRemove);
        alert('Thank you for subscription ;) You can add a tag!')
    }
</script>

 <!--Start of gravitec Zendesk Widget script -->
<!--<script>/*<![CDATA[*/window.zEmbed||function(e,t){var n,o,d,i,s,a=[],r=document.createElement("iframe");window.zEmbed=function(){a.push(arguments)},window.zE=window.zE||window.zEmbed,r.src="javascript:false",r.title="",r.role="presentation",(r.frameElement||r).style.cssText="display: none",d=document.getElementsByTagName("script"),d=d[d.length-1],d.parentNode.insertBefore(r,d),i=r.contentWindow,s=i.document;try{o=s}catch(e){n=document.domain,r.src='javascript:var d=document.open();d.domain="'+n+'";void(0);',o=s}o.open()._l=function(){var o=this.createElement("script");n&&(this.domain=n),o.id="js-iframe-async",o.src=e,this.t=+new Date,this.zendeskHost=t,this.zEQueue=a,this.body.appendChild(o)},o.write('<body onload="document._l();">'),o.close()}("https://assets.zendesk.com/embeddable_framework/main.js","gravitec.zendesk.com");-->
<!--/*]]>*/</script>-->
 <!--End of gravitec Zendesk Widget script -->
</body>
</html>
