<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>HI</title>
    <link rel="stylesheet" href="style.css">
    <script   src="https://code.jquery.com/jquery-2.2.4.min.js"   integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44="   crossorigin="anonymous"></script>
    <script src="https://cdn.gravitec.net/sites/gudz/client.js" async></script>
</head>
<body>
<div id="timerContainer"><span id="timer">10</span> sec to subscribe</div>
<div id="tagscontainer" style="display: none">
    <input type="text">
    <button class="add">Add tag</button>
    <p style="margin-top: 20px;">
        <button class="removeAll">Remove all tags</button>
    </p>
</div>
<script>
    var Gravitec = Gravitec || [];
    Gravitec.push(["init", {"autoRegister":false}]);
    var secs = 10;
    var timeContainer = document.getElementById('timer');
    var tagsContainer = $("#tagscontainer");
    var interval = setInterval(function() {
        if(secs > 0) {
            secs--;
            timeContainer.innerHTML = secs;
        }
        else {
            clearInterval(interval);
            onTimeout();
        }
    }, 1000);

    function onTimeout() {
        $('#timerContainer').hide();
        Gravitec.push([
            "registerUserForPush",
            onSubscribed
        ]);
        tagsContainer.show();
        tagsContainer.find('button.add').on('click', onTagAdd);
        tagsContainer.find('button.removeAll').on('click', onTagsRemove);

    }

    function onTagAdd() {
        var val = tagsContainer.find('input').val();
        if(val) {
            Gravitec.push(['addTag', val]);
        }
        else {
            alert('Tag entered is empty');
        }
    }

    function onTagsRemove() {
        Gravitec.push(["removeAllTags"]);
    }

    function onSubscribed() {
        alert('Thank you for subscription ;)')
    }
</script>
</body>
</html>
